# MLX Whisper - Быстрая голосовая диктовка для macOS

Минималистичная утилита для транскрибации речи в текст на macOS с использованием MLX и Whisper. Работает локально, без отправки данных в облако.

## Возможности

- **Мгновенная диктовка** - запись и распознавание одной фразы с автоматической вставкой в буфер обмена
- **Непрерывный режим** - последовательная запись нескольких фрагментов
- **Toggle-режим** - включение/выключение записи по горячей клавише
- **Мультиязычность** - поддержка русского, английского и автоопределение языка
- **Локальная работа** - все вычисления на вашем устройстве через Apple Silicon

## Установка

### Требования
- macOS с Apple Silicon (M1/M2/M3)
- Python 3.9+
- Homebrew

### Быстрая установка

```bash
# Клонирование репозитория
git clone git@github.com:maxim-malikov/huyulie.git
cd huyulie

# Создание виртуального окружения
python3 -m venv .venv
source .venv/bin/activate

# Установка зависимостей
pip install mlx-whisper sounddevice numpy

# Установка SoX для аудио-сигналов
brew install sox

# Делаем скрипты исполняемыми
chmod +x mlxw mlxw-toggle
```

## Использование

### Базовые команды

```bash
# Одна фраза с автоопределением языка
./mlxw

# Одна фраза на русском
./mlxw ru

# Одна фраза на английском
./mlxw en

# Непрерывный режим
./mlxw continuous
```

### Toggle-режим (включение/выключение по клавише)

```bash
# Запуск toggle-режима на русском
./mlxw-toggle ru

# На английском
./mlxw-toggle en
```

В toggle-режиме:
- **Пробел** - начать/остановить запись
- **q** - выйти из программы

### Горячие клавиши (через Hammerspoon)

Добавьте в `~/.hammerspoon/init.lua`:

```lua
-- CMD+Shift+D - быстрая диктовка
hs.hotkey.bind({"cmd", "shift"}, "D", function()
  os.execute("/Users/ВАШ_ЮЗЕР/mlxwhisper/mlxw &")
end)

-- CMD+Shift+T - toggle-режим
hs.hotkey.bind({"cmd", "shift"}, "T", function()
  os.execute("/Users/ВАШ_ЮЗЕР/mlxwhisper/mlxw-toggle &")
end)
```

## Архитектура

- `rt.py` - основной модуль записи и транскрибации
- `rt_toggle.py` - модуль для toggle-режима
- `mlxw` - обертка для командной строки
- `mlxw-toggle` - обертка для toggle-режима

Подробная документация по архитектуре в [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md).

## Особенности

- Использует MLX для максимальной производительности на Apple Silicon
- Автоматическая нормализация аудио для лучшего распознавания
- Звуковые сигналы начала/конца записи (через SoX)
- Результат автоматически копируется в буфер обмена

## Лицензия

MIT